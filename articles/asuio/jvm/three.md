# 类文件结构
## Class类文件结构
- Class文件是一组以8字节为基础单位的二进制流，各个数据项目严格按照数据紧凑的排列在Class文件之中，中间没有添加任何分隔符，这使得整个Class文件中存储的内容几乎都是程序运行的必要数据。当遇到需要占用8个字节以上空间的的数据项时，则会按照高位在前的方式分割成若干个8位字节进行存储。
- Class文件格式采用一种类似于C语言结构体的伪结构来存储，这种伪结构中只有两种数据类型：无符号数和表
- 无符号数：是基本的数据类型，以u1、u2、u4、u8来分别表示1个字节，2个字节，4个自己和8个字节，无符号数用来描述数字、索引引用、数量值、或者按照UTF-8编码构成的字符串值。
- 表：是由多个无符号数或其他表作为数据项构成的符合数据类型，所有表习惯性地以_info结尾。表是用于描述有层次关系的符合结构的数据，整个Class文件本质上就是一张表。
+ ***魔数与Class文件的版本***
  - 每个Class文件的头4个字节称为魔数，它的唯一作用是用于确定这个文件是否是一个能被虚拟机接收的Class文件。
  - 紧接着魔数的4个自己存储的是Class文件的版本号：第5个和第6个是次版本号（Minor Version），第7个和第8个字节是主版本号（Major Version）

  > Java7的环境运行Java8的代码时常常会抛一个异常，java.lang.UnsupportedClassVersionError:com/sun/tools/javac/Main : Unsupported major.minor version 52.0，便是Major Version超出虚拟机支持的范围

+ ***常量池***
  - 常量池入口紧跟在主次版号之后。
  - 常量池中常量的数量是不固定的，所以在常量池的入口需要放置一项u2类型的数据，代表常量池容量计数器。这个计数器的初始值是1，而不是0。
  - 常量池中主要存放两大类常量：字面量和符号引用。字面量比较接近于Java语言层面的常量概念。而符号引用自属于编译原理方面的概念，包含了三个方面:
    - 类和接口的全限定名
    - 字段的名称和描述符
    - 方法的名称和描述符
  - 常量池中每一项常量都是一个表，共有11种结构各不相同的表结构数据，每个表开始的第一位是一个u1类型的标志位。
## 未完待续
